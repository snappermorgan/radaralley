jQuery(document).ready(function(){function e(e){var t,n="",r=jQuery(".dslca-post-option-image",e);r.each(function(){t=jQuery(this);imageID=t.data("id");n+=imageID+" "});jQuery(".dslca-post-options-field-file",e).val(n)}function t(t){var n=t.closest(".dslca-post-option");t.remove();e(n)}jQuery(document).on("click",".dslca-post-option-image-remove",function(){t(jQuery(this).closest(".dslca-post-option-image"))});if(jQuery(".dslca-post-option-field-files .dslca-post-options-images").length){jQuery(".dslca-post-option-field-files .dslca-post-options-images").sortable({update:function(t,n){e(jQuery(this).closest(".dslca-post-option"))}});jQuery(".dslca-post-options-images").disableSelection()}var n;jQuery(".dslca-post-option-add-file-hook").click(function(){var e=jQuery(this);var t=jQuery(this).closest(".dslca-post-option");var r=jQuery(".dslca-post-options-field-file",t);var i=jQuery(".dslca-post-option-image",t);var s=false;if(e.data("multiple")){s=true}n=wp.media.frames.file_frame=wp.media({title:"Choose File",button:{text:"Send to option"},multiple:s});n.on("select",function(){if(s){attachments=n.state().get("selection").toJSON();attachmentVal="";for(var e=0;e<attachments.length;e++){attachment=attachments[e];attachmentVal+=attachment.id+" ";t.find(".dslca-post-options-images").append('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><img src="'+attachment.url+'" /><span class="dslca-post-option-image-remove">x</span></div></div>')}r.val(r.val()+attachmentVal)}else{attachment=n.state().get("selection").first().toJSON();if(attachment.type=="image"){if(i.length){i.find("img").attr("src",attachment.url)}else{t.find(".dslca-post-options-images").html('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><img src="'+attachment.url+'" /></div><span class="dslca-post-option-image-remove">x</span></div>')}}else{if(i.length){i.find("strong").text(attachment.filename)}else{t.find(".dslca-post-options-images").html('<div class="dslca-post-option-image" data-id="'+attachment.id+'"><div class="dslca-post-option-image-inner"><strong>'+attachment.filename+"</strong></div></div>")}}r.val(attachment.id)}});n.open()})})