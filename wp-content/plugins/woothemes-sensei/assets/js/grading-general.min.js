jQuery(document).ready(function(e){jQuery.fn.exists=function(){return this.length>0};jQuery.fn.calculateTotalGrade=function(){var e,t,n=0,r=0;jQuery(".question_box.user_right").each(function(){e=jQuery(this).find(".question_id").val();t=parseInt(jQuery(this).find("#question_"+e+"_grade").val());n+=t;r++});jQuery(".question_box.user_wrong").each(function(){r++});jQuery("#total_graded_questions").val(r);var i=parseInt(jQuery("#total_questions").val()),s=parseInt(jQuery("#quiz_grade_total").val()),o=parseFloat(n*100/s).toFixed(2);o=o.replace(".00","");jQuery("#total_grade").val(n);jQuery(".total_grade_total").html(n);jQuery(".total_grade_percent").html(o);jQuery(".quiz_grade_total").html(s);if(i==r){jQuery("#all_questions_graded").val("yes");jQuery(".grade-button").val("Grade")}else{jQuery("#all_questions_graded").val("no");jQuery(".grade-button").val("Save")}};jQuery.fn.autoGrade=function(){jQuery(".question_box").each(function(){if(!jQuery(this).hasClass("user_right")&&!jQuery(this).hasClass("user_wrong")){jQuery(this).addClass("ungraded");if(jQuery(this).hasClass("gap-fill"))var e=jQuery(this).find(".user-answer .highlight").html(),t=jQuery(this).find(".correct-answer .highlight").html();else var e=jQuery(this).find(".user-answer").html(),t=jQuery(this).find(".correct-answer").html();if(e==t){jQuery(this).addClass("user_right").removeClass("user_wrong").removeClass("ungraded");jQuery(this).find(".grading-mark.icon_right input").attr("checked",!0);jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!1);jQuery(this).find("input.question-grade").val(jQuery(this).find("input.question_total_grade").val())}else if(jQuery(this).hasClass("auto-grade")){jQuery(this).addClass("user_wrong").removeClass("user_right").removeClass("ungraded");jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!0);jQuery(this).find(".grading-mark.icon_right input").attr("checked",!1);jQuery(this).find(".input.question-grade").val(0)}else{jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!1);jQuery(this).find(".grading-mark.icon_right input").attr("checked",!1);jQuery(this).removeClass("user_wrong").removeClass("user_right")}}});jQuery.fn.calculateTotalGrade()};jQuery.fn.resetGrades=function(){jQuery(".question_box").find(".grading-mark.icon_wrong input").attr("checked",!1);jQuery(".question_box").find(".grading-mark.icon_right input").attr("checked",!1);jQuery(".question_box").removeClass("user_wrong").removeClass("user_right").removeClass("ungraded");jQuery(".question-grade").val("0");jQuery.fn.calculateTotalGrade()};jQuery.fn.getQueryVariable=function(e){var t=window.location.search.substring(1),n=t.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");if(i[0]==e)return i[1]}return!1};jQuery("#grading-course-options").on("change","",function(){var e=jQuery(this).val(),t="";t+="course_id="+e;jQuery.post(ajaxurl,{action:"get_lessons_dropdown",get_lessons_dropdown_nonce:woo_localized_data.get_lessons_dropdown_nonce,data:t},function(e){if(""!=e){jQuery("#learners-to-grade").empty();jQuery("#learners-graded").empty();jQuery("#grading-lesson-options").empty().append(e);if(jQuery("#grading-lesson-options").exists()){jQuery("#grading-lesson-options-label").show();jQuery("#grading-lesson-options").trigger("chosen:updated")}}});return!1});jQuery("#grading-lesson-options").on("change","",function(){var e=jQuery(this).val(),t=jQuery("#grading-course-options").val(),n="";n+="lesson_id="+e;n+="&course_id="+t;var r=jQuery.fn.getQueryVariable("grading_status");r?n+="&grading_status="+r:n+="&grading_status=ungraded";jQuery.post(ajaxurl,{action:"get_redirect_url",get_lessons_html_nonce:woo_localized_data.get_lessons_html_nonce,data:n},function(e){console.log(e);""!=e&&(window.location=e)});return!1});jQuery(".grading-mark").on("change","input",function(){if(this.value=="right"){jQuery("#"+this.name+"_box").addClass("user_right").removeClass("user_wrong");jQuery("#"+this.name+"_box").find("input.question-grade").val(jQuery("#"+this.name+"_box").find("input.question_total_grade").val())}else{jQuery("#"+this.name+"_box").addClass("user_wrong").removeClass("user_right");jQuery("#"+this.name+"_box").find("input.question-grade").val(0)}jQuery.fn.calculateTotalGrade()});jQuery(".question-grade").on("change","",function(){var e=parseInt(jQuery(this).val()),t=this.id.replace("_grade","");if(e>0){jQuery("#"+t+"_box").addClass("user_right").removeClass("user_wrong");jQuery("#"+t+"_box .grading-mark input."+t+"_right_option").attr("checked","checked");jQuery("#"+t+"_box .grading-mark input."+t+"_wrong_option").attr("checked",!1)}else{jQuery("#"+t+"_box").addClass("user_wrong").removeClass("user_right");jQuery("#"+t+"_box .grading-mark input."+t+"_wrong_option").attr("checked","checked");jQuery("#"+t+"_box .grading-mark input."+t+"_right_option").attr("checked",!1)}jQuery.fn.calculateTotalGrade()});jQuery(".sensei-grading-main .buttons").on("click",".reset-button",function(){jQuery.fn.resetGrades()});jQuery(".sensei-grading-main .buttons").on("click",".autograde-button",function(){jQuery.fn.autoGrade()});jQuery("#grading-course-options").exists()&&jQuery("#grading-course-options").chosen();jQuery("#grading-lesson-options").exists()&&jQuery("#grading-lesson-options").chosen()});